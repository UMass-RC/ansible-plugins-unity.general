todos_fixmes:
  image: alpine
  script:
    - apk add ripgrep curl tree
    - set +e
    - ls
    - tree
    - rg --no-ignore TODO
    - rg --no-ignore FIXME
    - rg TODO | wc -l
    - rg FIXME | wc -l
    - todo_count="$(rg TODO | wc -l)"
    - fixme_count="$(rg FIXME | wc -l)"
    - set -e
    - 'echo "todo count: $todo_count"'
    - 'echo "fixme count: $fixme_count"'
    - curl "https://shields.io/badge/TODOs-$todo_count-blue" > todos.svg
    - curl "https://shields.io/badge/FIXMEs-$fixme_count-red" > fixmes.svg
  artifacts:
    paths:
      - todos.svg
      - fixmes.svg
    expire_in: 1 week
